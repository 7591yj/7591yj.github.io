---
import Layout from "../layouts/Layout.astro";
import PageHeading from "../components/PageHeading.astro";
import ProjectGraph from "../components/graph/ProjectGraph";
import { SITE_NAME } from "../consts";
import type { Project } from "../types";

const mdxModules = import.meta.glob<{ frontmatter: Record<string, any>; url: string }>(
  "./projects/*.mdx",
  { eager: true },
);
const allProjects: Project[] = Object.values(mdxModules).map((p) => ({
  title: p.frontmatter.title,
  subtitle: p.frontmatter.subtitle,
  status: p.frontmatter.status,
  desc: p.frontmatter.desc ?? [],
  tech: p.frontmatter.tech ?? [],
  tags: p.frontmatter.tags ?? [],
  images: p.frontmatter.images,
  current: p.frontmatter.current,
  category: p.frontmatter.category,
  slug: p.url!.split("/").pop()!,
  href: p.frontmatter.link,
}));
---

<Layout title={`${SITE_NAME} | Projects`}>
  <main>
    <section>
      <PageHeading module="MODULE.001///" title="Projects" />
    </section>

    <section class="schematic">
      <ProjectGraph projects={allProjects} client:visible />
    </section>

    <style>
      .schematic {
        position: relative;
        max-width: 100%;
        margin-inline: auto;
        padding: 2rem 0;
        border-top: 1px solid var(--color-border);
      }

      @media (max-width: 768px) {
        .schematic {
          max-width: 90%;
        }
      }
    </style>
  </main>
</Layout>
