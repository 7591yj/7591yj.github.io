---
import DetailLayout from "./DetailLayout.astro";
import { SITE_NAME } from "../consts";

interface Frontmatter {
  title: string;
  date: string;
  description?: string;
  tags?: string[];
}

const { title, date, description, tags } =
  Astro.props.frontmatter as Frontmatter;
const headings = Astro.props.headings ?? [];

function formatDate(dateStr: string) {
  const d = new Date(dateStr);
  const y = d.getFullYear();
  const m = String(d.getMonth() + 1).padStart(2, "0");
  const day = String(d.getDate()).padStart(2, "0");
  return `${y}.${m}.${day}`;
}
---

<DetailLayout
  title={`${SITE_NAME} | ${title}`}
  module="MODULE.002///"
  headingTitle={title}
  backLinkHref="/blog"
  backLinkLabel="Back to blog"
  headings={headings}
>
  <div class="meta" slot="meta">
    <span class="meta__label">DATE</span>
    <span class="meta__value">{formatDate(date)}</span>
    {
      tags && tags.length > 0 && (
        <>
          <span class="meta__label">TAGS</span>
          <div class="meta__tags">
            {tags.map((t) => (
              <span class="meta__tag">{t}</span>
            ))}
          </div>
        </>
      )
    }
  </div>

  <slot />
</DetailLayout>

<style>
  .meta__tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.35rem;
  }

  .meta__tag {
    font-family: monospace;
    font-size: var(--font-size-xs);
    padding: 0.2em 0.6em;
    background: var(--color-bg-tertiary);
    color: var(--color-text-muted);
    border: 1px solid var(--color-border);
  }
</style>
